<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UltimaLive: ClientRedirections Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">UltimaLive
   &#160;<span id="projectnumber">0.98</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="classClientRedirections-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ClientRedirections Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>ClientsRedirections contains redirected client functions.  
 <a href="classClientRedirections.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="ClientRedirections_8h_source.html">ClientRedirections.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ac2b4264a7d7600ee7c2da1ab5f60f7e2"><td class="memItemLeft" align="right" valign="top">static HANDLE WINAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClientRedirections.html#ac2b4264a7d7600ee7c2da1ab5f60f7e2">OnCreateFileARunOnce</a> (__in LPCSTR lpFileName, __in DWORD dwDesiredAccess, __in DWORD dwShareMode, __in_opt LPSECURITY_ATTRIBUTES lpSecurityAttributes, __in DWORD dwCreationDisposition, __in DWORD dwFlagsAndAttributes, __in_opt HANDLE hTemplateFile)</td></tr>
<tr class="memdesc:ac2b4264a7d7600ee7c2da1ab5f60f7e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is hooked into the client by the Igrping.dll's main function. It executes once and calls the startup of <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a>. <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a> in turn rehooks this function with the permanent one.  <a href="#ac2b4264a7d7600ee7c2da1ab5f60f7e2">More...</a><br /></td></tr>
<tr class="separator:ac2b4264a7d7600ee7c2da1ab5f60f7e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a433831426d67576aab6d2264640e32c6"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClientRedirections.html#a433831426d67576aab6d2264640e32c6">InstallClientHooks</a> ()</td></tr>
<tr class="memdesc:a433831426d67576aab6d2264640e32c6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Installs function hooks into the client to redirect client functions to <a class="el" href="classClientRedirections.html" title="ClientsRedirections contains redirected client functions. ">ClientRedirections</a> functions.  <a href="#a433831426d67576aab6d2264640e32c6">More...</a><br /></td></tr>
<tr class="separator:a433831426d67576aab6d2264640e32c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a929ed3b012ab3246300abec3911af980"><td class="memItemLeft" align="right" valign="top"><a id="a929ed3b012ab3246300abec3911af980"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClientRedirections.html#a929ed3b012ab3246300abec3911af980">OnUpdateStaticBlocks</a> ()</td></tr>
<tr class="memdesc:a929ed3b012ab3246300abec3911af980"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function adds a mutex around the updates static blocks function in the client to avoid issues caused by the client calling this function at the same time as <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a>. <br /></td></tr>
<tr class="separator:a929ed3b012ab3246300abec3911af980"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:ab32e8493b14fb2a326601608bc548a4c"><td class="memItemLeft" align="right" valign="top">static HANDLE WINAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClientRedirections.html#ab32e8493b14fb2a326601608bc548a4c">OnCreateFileA</a> (__in LPCSTR lpFileName, __in DWORD dwDesiredAccess, __in DWORD dwShareMode, __in_opt LPSECURITY_ATTRIBUTES lpSecurityAttributes, __in DWORD dwCreationDisposition, __in DWORD dwFlagsAndAttributes, __in_opt HANDLE hTemplateFile)</td></tr>
<tr class="memdesc:ab32e8493b14fb2a326601608bc548a4c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is hooked by <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a>'s startup function. It relays the CreateFileA function to the <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a> file manager, which in turn relays it to any <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a> subscribers to process before optionally calling the original function.  <a href="#ab32e8493b14fb2a326601608bc548a4c">More...</a><br /></td></tr>
<tr class="separator:ab32e8493b14fb2a326601608bc548a4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7945d27b02199fbd991af336531c21f1"><td class="memItemLeft" align="right" valign="top">static LPVOID WINAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClientRedirections.html#a7945d27b02199fbd991af336531c21f1">OnMapViewOfFile</a> (__in HANDLE hFileMappingObject, __in DWORD dwDesiredAccess, __in DWORD dwFileOffsetHigh, __in DWORD dwFileOffsetLow, __in SIZE_T dwNumberOfBytesToMap)</td></tr>
<tr class="separator:a7945d27b02199fbd991af336531c21f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e0e874f90084aa5cbaff93cdd06d37c"><td class="memItemLeft" align="right" valign="top">static HANDLE WINAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClientRedirections.html#a0e0e874f90084aa5cbaff93cdd06d37c">OnCreateFileMappingA</a> (__in HANDLE hFile, __in_opt LPSECURITY_ATTRIBUTES lpAttributes, __in DWORD flProtect, __in DWORD dwMaximumSizeHigh, __in DWORD dwMaximumSizeLow, __in_opt LPCSTR lpName)</td></tr>
<tr class="memdesc:a0e0e874f90084aa5cbaff93cdd06d37c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is hooked into the client's CreateFileMapping function. It redirects control to one of <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a>'s concrete <a class="el" href="classFileManager.html" title="FileManager class for clients using MUL files. ">FileManager</a> classes.  <a href="#a0e0e874f90084aa5cbaff93cdd06d37c">More...</a><br /></td></tr>
<tr class="separator:a0e0e874f90084aa5cbaff93cdd06d37c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac321be699ed72fa4fc3b0f4eb4c3bb2e"><td class="memItemLeft" align="right" valign="top">static int WINAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClientRedirections.html#ac321be699ed72fa4fc3b0f4eb4c3bb2e">OnMessageBox</a> (_In_opt_ HWND hWnd, _In_opt_ LPCTSTR lpText, _In_opt_ LPCTSTR lpCaption, _In_ UINT uType)</td></tr>
<tr class="memdesc:ac321be699ed72fa4fc3b0f4eb4c3bb2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is hooked into the client's MessageBox function.  <a href="#ac321be699ed72fa4fc3b0f4eb4c3bb2e">More...</a><br /></td></tr>
<tr class="separator:ac321be699ed72fa4fc3b0f4eb4c3bb2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02af7a95d91499be506dc5fac3d1f5ec"><td class="memItemLeft" align="right" valign="top">static BOOL WINAPI&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClientRedirections.html#a02af7a95d91499be506dc5fac3d1f5ec">OnCloseHandle</a> (_In_ HANDLE hObject)</td></tr>
<tr class="memdesc:a02af7a95d91499be506dc5fac3d1f5ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">This method is hooked into the client's CloseHandle function. It redirects control to one of <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a>'s concrete <a class="el" href="classFileManager.html" title="FileManager class for clients using MUL files. ">FileManager</a> classes.  <a href="#a02af7a95d91499be506dc5fac3d1f5ec">More...</a><br /></td></tr>
<tr class="separator:a02af7a95d91499be506dc5fac3d1f5ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b9e10876a874d9f31a97e6cd1b3e567"><td class="memItemLeft" align="right" valign="top">static void __fastcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClientRedirections.html#a1b9e10876a874d9f31a97e6cd1b3e567">OnReceivePacket</a> (void *This, void *edx, unsigned char *pBuffer)</td></tr>
<tr class="memdesc:a1b9e10876a874d9f31a97e6cd1b3e567"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is called in place of the client's network receive function. It passes control to the <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a> network manager which gives its subscribers the chance to alter/process each network packet before the client. It then calls the clients receive function.  <a href="#a1b9e10876a874d9f31a97e6cd1b3e567">More...</a><br /></td></tr>
<tr class="separator:a1b9e10876a874d9f31a97e6cd1b3e567"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedd8fe7903f8debe2db51e1762ac1a78"><td class="memItemLeft" align="right" valign="top">static int __fastcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClientRedirections.html#aedd8fe7903f8debe2db51e1762ac1a78">OnSendPacket</a> (void *This, void *edx, unsigned char *pBuffer)</td></tr>
<tr class="memdesc:aedd8fe7903f8debe2db51e1762ac1a78"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is called in place of the client's network send function. It passes control to the <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a> network manager which gives its subscribers the chance to alter/process each network packet before they are sent to the server. It then calls the clients receive function.  <a href="#aedd8fe7903f8debe2db51e1762ac1a78">More...</a><br /></td></tr>
<tr class="separator:aedd8fe7903f8debe2db51e1762ac1a78"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:afed320c7d4ae794736027b463f080cef"><td class="memItemLeft" align="right" valign="top"><a id="afed320c7d4ae794736027b463f080cef"></a>
static HANDLE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classClientRedirections.html#afed320c7d4ae794736027b463f080cef">g_UpdateStaticBlocksMutex</a> = CreateMutex(NULL, false, NULL)</td></tr>
<tr class="memdesc:afed320c7d4ae794736027b463f080cef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutex for the redirected UpdateStaticBlocksMutex function. <br /></td></tr>
<tr class="separator:afed320c7d4ae794736027b463f080cef"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>ClientsRedirections contains redirected client functions. </p>

<p class="definition">Definition at line <a class="el" href="ClientRedirections_8h_source.html#l00040">40</a> of file <a class="el" href="ClientRedirections_8h_source.html">ClientRedirections.h</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a433831426d67576aab6d2264640e32c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a433831426d67576aab6d2264640e32c6">&#9670;&nbsp;</a></span>InstallClientHooks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool ClientRedirections::InstallClientHooks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Installs function hooks into the client to redirect client functions to <a class="el" href="classClientRedirections.html" title="ClientsRedirections contains redirected client functions. ">ClientRedirections</a> functions. </p>
<dl class="section return"><dt>Returns</dt><dd>true if successful </dd></dl>

<p class="definition">Definition at line <a class="el" href="ClientRedirections_8cpp_source.html#l00033">33</a> of file <a class="el" href="ClientRedirections_8cpp_source.html">ClientRedirections.cpp</a>.</p>

<p class="reference">References <a class="el" href="Debug_8h_source.html#l00110">Logger::g_pLogger</a>, <a class="el" href="UltimaLive_8h_source.html#l00048">UltimaLive::g_pUltimaLive</a>, <a class="el" href="ClientRedirections_8h_source.html#l00066">g_UpdateStaticBlocksMutex</a>, <a class="el" href="Utils_8cpp_source.html#l00053">Utils::GetCurrentModuleName()</a>, <a class="el" href="classLogger.html#a827dd7de91559307344d98a5a939da1e">Logger::LogPrint()</a>, <a class="el" href="classLogger.html#a88385ddd15152239e0010cc4ef631f92">Logger::LogPrintTaskStatusResult()</a>, <a class="el" href="classLogger.html#a9ee915d2b364756f10e95ef9565d5903">Logger::LogPrintWithoutDate()</a>, <a class="el" href="ClientRedirections_8cpp_source.html#l00374">OnCloseHandle()</a>, <a class="el" href="ClientRedirections_8cpp_source.html#l00257">OnCreateFileA()</a>, <a class="el" href="ClientRedirections_8cpp_source.html#l00347">OnCreateFileMappingA()</a>, <a class="el" href="ClientRedirections_8cpp_source.html#l00288">OnMapViewOfFile()</a>, <a class="el" href="ClientRedirections_8cpp_source.html#l00318">OnMessageBox()</a>, <a class="el" href="ClientRedirections_8cpp_source.html#l00161">OnReceivePacket()</a>, <a class="el" href="ClientRedirections_8cpp_source.html#l00181">OnSendPacket()</a>, and <a class="el" href="ClientRedirections_8cpp_source.html#l00198">OnUpdateStaticBlocks()</a>.</p>

<p class="reference">Referenced by <a class="el" href="UltimaLive_8cpp_source.html#l00080">UltimaLive::Start()</a>.</p>

</div>
</div>
<a id="a02af7a95d91499be506dc5fac3d1f5ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02af7a95d91499be506dc5fac3d1f5ec">&#9670;&nbsp;</a></span>OnCloseHandle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">BOOL WINAPI ClientRedirections::OnCloseHandle </td>
          <td>(</td>
          <td class="paramtype">_In_ HANDLE&#160;</td>
          <td class="paramname"><em>hObject</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method is hooked into the client's CloseHandle function. It redirects control to one of <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a>'s concrete <a class="el" href="classFileManager.html" title="FileManager class for clients using MUL files. ">FileManager</a> classes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hObject</td><td>A valid handle to an open object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If the function succeeds, the return value is nonzero. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ClientRedirections_8cpp_source.html#l00374">374</a> of file <a class="el" href="ClientRedirections_8cpp_source.html">ClientRedirections.cpp</a>.</p>

<p class="reference">References <a class="el" href="UltimaLive_8h_source.html#l00048">UltimaLive::g_pUltimaLive</a>, <a class="el" href="Client_8cpp_source.html#l00605">Client::GetFileManager()</a>, <a class="el" href="UltimaLive_8h_source.html#l00058">UltimaLive::m_pClient</a>, and <a class="el" href="BaseFileManager_8cpp_source.html#l00634">BaseFileManager::OnCloseHandle()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ClientRedirections_8cpp_source.html#l00033">InstallClientHooks()</a>.</p>

</div>
</div>
<a id="ab32e8493b14fb2a326601608bc548a4c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab32e8493b14fb2a326601608bc548a4c">&#9670;&nbsp;</a></span>OnCreateFileA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">HANDLE WINAPI ClientRedirections::OnCreateFileA </td>
          <td>(</td>
          <td class="paramtype">__in LPCSTR&#160;</td>
          <td class="paramname"><em>lpFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>dwDesiredAccess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>dwShareMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in_opt LPSECURITY_ATTRIBUTES&#160;</td>
          <td class="paramname"><em>lpSecurityAttributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>dwCreationDisposition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>dwFlagsAndAttributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in_opt HANDLE&#160;</td>
          <td class="paramname"><em>hTemplateFile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function is hooked by <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a>'s startup function. It relays the CreateFileA function to the <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a> file manager, which in turn relays it to any <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a> subscribers to process before optionally calling the original function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lpFileName</td><td>The name of the file or device to be created or opened. </td></tr>
    <tr><td class="paramname">dwDesiredAccess</td><td>The requested access to the file or device, which can be summarized as read, write, both or neither. </td></tr>
    <tr><td class="paramname">dwShareMode</td><td>The requested sharing mode of the file or device, which can be read, write, both, delete, all of these, or none. </td></tr>
    <tr><td class="paramname">lpSecurityAttributes</td><td>A pointer to a SECURITY_ATTRIBUTES structure that contains two separate but related data members. </td></tr>
    <tr><td class="paramname">dwCreationDisposition</td><td>An action to take on a file or device that exists or does not exist. </td></tr>
    <tr><td class="paramname">dwFlagsAndAttributes</td><td>The file or device attributes and flags, FILE_ATTRIBUTE_NORMAL being the most common default value for files. </td></tr>
    <tr><td class="paramname">hTemplateFile</td><td>A valid handle to a template file with the GENERIC_READ access right.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New File's Handle </dd></dl>

<p class="definition">Definition at line <a class="el" href="ClientRedirections_8cpp_source.html#l00257">257</a> of file <a class="el" href="ClientRedirections_8cpp_source.html">ClientRedirections.cpp</a>.</p>

<p class="reference">References <a class="el" href="UltimaLive_8h_source.html#l00048">UltimaLive::g_pUltimaLive</a>, <a class="el" href="Client_8cpp_source.html#l00605">Client::GetFileManager()</a>, <a class="el" href="UltimaLive_8h_source.html#l00058">UltimaLive::m_pClient</a>, and <a class="el" href="BaseFileManager_8cpp_source.html#l00661">BaseFileManager::OnCreateFileA()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ClientRedirections_8cpp_source.html#l00033">InstallClientHooks()</a>.</p>

</div>
</div>
<a id="ac2b4264a7d7600ee7c2da1ab5f60f7e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2b4264a7d7600ee7c2da1ab5f60f7e2">&#9670;&nbsp;</a></span>OnCreateFileARunOnce()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">HANDLE WINAPI ClientRedirections::OnCreateFileARunOnce </td>
          <td>(</td>
          <td class="paramtype">__in LPCSTR&#160;</td>
          <td class="paramname"><em>lpFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>dwDesiredAccess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>dwShareMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in_opt LPSECURITY_ATTRIBUTES&#160;</td>
          <td class="paramname"><em>lpSecurityAttributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>dwCreationDisposition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>dwFlagsAndAttributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in_opt HANDLE&#160;</td>
          <td class="paramname"><em>hTemplateFile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function is hooked into the client by the Igrping.dll's main function. It executes once and calls the startup of <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a>. <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a> in turn rehooks this function with the permanent one. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lpFileName</td><td>The name of the file or device to be created or opened. </td></tr>
    <tr><td class="paramname">dwDesiredAccess</td><td>The requested access to the file or device, which can be summarized as read, write, both or neither. </td></tr>
    <tr><td class="paramname">dwShareMode</td><td>The requested sharing mode of the file or device, which can be read, write, both, delete, all of these, or none. </td></tr>
    <tr><td class="paramname">lpSecurityAttributes</td><td>A pointer to a SECURITY_ATTRIBUTES structure that contains two separate but related data members. </td></tr>
    <tr><td class="paramname">dwCreationDisposition</td><td>An action to take on a file or device that exists or does not exist. </td></tr>
    <tr><td class="paramname">dwFlagsAndAttributes</td><td>The file or device attributes and flags, FILE_ATTRIBUTE_NORMAL being the most common default value for files. </td></tr>
    <tr><td class="paramname">hTemplateFile</td><td>A valid handle to a template file with the GENERIC_READ access right.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New File's Handle </dd></dl>

<p class="definition">Definition at line <a class="el" href="ClientRedirections_8cpp_source.html#l00220">220</a> of file <a class="el" href="ClientRedirections_8cpp_source.html">ClientRedirections.cpp</a>.</p>

<p class="reference">References <a class="el" href="UltimaLive_8h_source.html#l00048">UltimaLive::g_pUltimaLive</a>, <a class="el" href="Client_8cpp_source.html#l00605">Client::GetFileManager()</a>, <a class="el" href="UltimaLive_8h_source.html#l00058">UltimaLive::m_pClient</a>, <a class="el" href="BaseFileManager_8cpp_source.html#l00661">BaseFileManager::OnCreateFileA()</a>, and <a class="el" href="UltimaLive_8cpp_source.html#l00080">UltimaLive::Start()</a>.</p>

</div>
</div>
<a id="a0e0e874f90084aa5cbaff93cdd06d37c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e0e874f90084aa5cbaff93cdd06d37c">&#9670;&nbsp;</a></span>OnCreateFileMappingA()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">HANDLE WINAPI ClientRedirections::OnCreateFileMappingA </td>
          <td>(</td>
          <td class="paramtype">__in HANDLE&#160;</td>
          <td class="paramname"><em>hFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in_opt LPSECURITY_ATTRIBUTES&#160;</td>
          <td class="paramname"><em>lpAttributes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>flProtect</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>dwMaximumSizeHigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>dwMaximumSizeLow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in_opt LPCSTR&#160;</td>
          <td class="paramname"><em>lpName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method is hooked into the client's CreateFileMapping function. It redirects control to one of <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a>'s concrete <a class="el" href="classFileManager.html" title="FileManager class for clients using MUL files. ">FileManager</a> classes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hFile</td><td>A handle to the file from which to create a file mapping object. </td></tr>
    <tr><td class="paramname">lpAttributes</td><td>A pointer to a SECURITY_ATTRIBUTES structure that determines whether a returned handle can be inherited by child processes. </td></tr>
    <tr><td class="paramname">flProtect</td><td>Specifies the page protection of the file mapping object. </td></tr>
    <tr><td class="paramname">dwMaximumSizeHigh</td><td>The high-order DWORD of the maximum size of the file mapping object. </td></tr>
    <tr><td class="paramname">dwMaximumSizeLow</td><td>The low-order DWORD of the maximum size of the file mapping object. </td></tr>
    <tr><td class="paramname">lpName</td><td>The name of the file mapping object.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If the function succeeds, the return value is a handle to the newly created file mapping object. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ClientRedirections_8cpp_source.html#l00347">347</a> of file <a class="el" href="ClientRedirections_8cpp_source.html">ClientRedirections.cpp</a>.</p>

<p class="reference">References <a class="el" href="UltimaLive_8h_source.html#l00048">UltimaLive::g_pUltimaLive</a>, <a class="el" href="Client_8cpp_source.html#l00605">Client::GetFileManager()</a>, <a class="el" href="UltimaLive_8h_source.html#l00058">UltimaLive::m_pClient</a>, and <a class="el" href="BaseFileManager_8cpp_source.html#l00699">BaseFileManager::OnCreateFileMappingA()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ClientRedirections_8cpp_source.html#l00033">InstallClientHooks()</a>.</p>

</div>
</div>
<a id="a7945d27b02199fbd991af336531c21f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7945d27b02199fbd991af336531c21f1">&#9670;&nbsp;</a></span>OnMapViewOfFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">LPVOID WINAPI ClientRedirections::OnMapViewOfFile </td>
          <td>(</td>
          <td class="paramtype">__in HANDLE&#160;</td>
          <td class="paramname"><em>hFileMappingObject</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>dwDesiredAccess</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>dwFileOffsetHigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in DWORD&#160;</td>
          <td class="paramname"><em>dwFileOffsetLow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__in SIZE_T&#160;</td>
          <td class="paramname"><em>dwNumberOfBytesToMap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This method is hooked into the client's MapViewOfFile function. It relays control to one of <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a>'s concrete file managers.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hFileMappingObject</td><td>A handle to a file mapping object. </td></tr>
    <tr><td class="paramname">dwDesiredAccess</td><td>The type of access to a file mapping object, which determines the protection of the pages. </td></tr>
    <tr><td class="paramname">dwFileOffsetHigh</td><td>A high-order DWORD of the file offset where the view begins. </td></tr>
    <tr><td class="paramname">dwFileOffsetLow</td><td>A low-order DWORD of the file offset where the view is to begin. </td></tr>
    <tr><td class="paramname">dwNumberOfBytesToMap</td><td>The number of bytes of a file mapping to map to the view.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The starting address of the mapped view </dd></dl>

<p class="definition">Definition at line <a class="el" href="ClientRedirections_8cpp_source.html#l00288">288</a> of file <a class="el" href="ClientRedirections_8cpp_source.html">ClientRedirections.cpp</a>.</p>

<p class="reference">References <a class="el" href="UltimaLive_8h_source.html#l00048">UltimaLive::g_pUltimaLive</a>, <a class="el" href="Client_8cpp_source.html#l00605">Client::GetFileManager()</a>, <a class="el" href="UltimaLive_8h_source.html#l00058">UltimaLive::m_pClient</a>, and <a class="el" href="BaseFileManager_8cpp_source.html#l00740">BaseFileManager::OnMapViewOfFile()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ClientRedirections_8cpp_source.html#l00033">InstallClientHooks()</a>.</p>

</div>
</div>
<a id="ac321be699ed72fa4fc3b0f4eb4c3bb2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac321be699ed72fa4fc3b0f4eb4c3bb2e">&#9670;&nbsp;</a></span>OnMessageBox()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int WINAPI ClientRedirections::OnMessageBox </td>
          <td>(</td>
          <td class="paramtype">_In_opt_ HWND&#160;</td>
          <td class="paramname"><em>hWnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_opt_ LPCTSTR&#160;</td>
          <td class="paramname"><em>lpText</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_opt_ LPCTSTR&#160;</td>
          <td class="paramname"><em>lpCaption</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_In_ UINT&#160;</td>
          <td class="paramname"><em>uType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This method is hooked into the client's MessageBox function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hWnd</td><td>A handle to the owner window of the message box to be created. </td></tr>
    <tr><td class="paramname">lpText</td><td>The message to be displayed. </td></tr>
    <tr><td class="paramname">lpCaption</td><td>The dialog box title. </td></tr>
    <tr><td class="paramname">uType</td><td>The contents and behavior of the dialog box.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If a message box has a Cancel button, the function returns the IDCANCEL value if either the ESC key is pressed or the Cancel button is selected. If the message box has no Cancel button, pressing ESC has no effect. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ClientRedirections_8cpp_source.html#l00318">318</a> of file <a class="el" href="ClientRedirections_8cpp_source.html">ClientRedirections.cpp</a>.</p>

<p class="reference">References <a class="el" href="Debug_8h_source.html#l00110">Logger::g_pLogger</a>, and <a class="el" href="classLogger.html#a827dd7de91559307344d98a5a939da1e">Logger::LogPrint()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ClientRedirections_8cpp_source.html#l00033">InstallClientHooks()</a>.</p>

</div>
</div>
<a id="a1b9e10876a874d9f31a97e6cd1b3e567"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b9e10876a874d9f31a97e6cd1b3e567">&#9670;&nbsp;</a></span>OnReceivePacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void __fastcall ClientRedirections::OnReceivePacket </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>This</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>edx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>pBuffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function is called in place of the client's network receive function. It passes control to the <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a> network manager which gives its subscribers the chance to alter/process each network packet before the client. It then calls the clients receive function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">This</td><td>Instance pointer </td></tr>
    <tr><td class="paramname">edx</td><td>unknown </td></tr>
    <tr><td class="paramname">pBuffer</td><td>Pointer to packet data </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="ClientRedirections_8cpp_source.html#l00161">161</a> of file <a class="el" href="ClientRedirections_8cpp_source.html">ClientRedirections.cpp</a>.</p>

<p class="reference">References <a class="el" href="UltimaLive_8h_source.html#l00048">UltimaLive::g_pUltimaLive</a>, <a class="el" href="Client_8cpp_source.html#l00463">Client::getRecvFunction()</a>, and <a class="el" href="UltimaLive_8h_source.html#l00058">UltimaLive::m_pClient</a>.</p>

<p class="reference">Referenced by <a class="el" href="ClientRedirections_8cpp_source.html#l00033">InstallClientHooks()</a>.</p>

</div>
</div>
<a id="aedd8fe7903f8debe2db51e1762ac1a78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedd8fe7903f8debe2db51e1762ac1a78">&#9670;&nbsp;</a></span>OnSendPacket()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int __fastcall ClientRedirections::OnSendPacket </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>This</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>edx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>pBuffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function is called in place of the client's network send function. It passes control to the <a class="el" href="classUltimaLive.html" title="Enables map streaming to the client and definition and use of additional maps. ">UltimaLive</a> network manager which gives its subscribers the chance to alter/process each network packet before they are sent to the server. It then calls the clients receive function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">This</td><td>Pointer to class instance </td></tr>
    <tr><td class="paramname">edx</td><td>unknown </td></tr>
    <tr><td class="paramname">pBuffer</td><td>Pointer to packet data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 </dd></dl>

<p class="definition">Definition at line <a class="el" href="ClientRedirections_8cpp_source.html#l00181">181</a> of file <a class="el" href="ClientRedirections_8cpp_source.html">ClientRedirections.cpp</a>.</p>

<p class="reference">References <a class="el" href="UltimaLive_8h_source.html#l00048">UltimaLive::g_pUltimaLive</a>, <a class="el" href="Client_8cpp_source.html#l00471">Client::getSendFunction()</a>, and <a class="el" href="UltimaLive_8h_source.html#l00058">UltimaLive::m_pClient</a>.</p>

<p class="reference">Referenced by <a class="el" href="ClientRedirections_8cpp_source.html#l00033">InstallClientHooks()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>UltimaLive/<a class="el" href="ClientRedirections_8h_source.html">ClientRedirections.h</a></li>
<li>UltimaLive/<a class="el" href="ClientRedirections_8cpp_source.html">ClientRedirections.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Feb 22 2017 23:12:42 for UltimaLive by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
